Для создания установочного файла .exe из Python-скрипта с добавлением автоматической установки `Arduino CLI` и сохранением файлов в той же директории, вы можете использовать такие инструменты, как **PyInstaller** для компиляции Python в .exe, а также использовать **Inno Setup** или **NSIS** для создания установочного пакета.

Вот пошаговая инструкция:

### 1. Установка необходимых инструментов

Убедитесь, что у вас установлены следующие инструменты:

- **PyInstaller** для компиляции Python-скрипта:

```bash   
pip install pyinstaller
```

- **Inno Setup** (скачать с официального сайта) или **NSIS** (скачать с официального сайта) для создания инсталлятора.

### 2. Компиляция Python-скрипта в .exe

1. **Подготовка сборки:**

	- Убедитесь, что ваш скрипт и файл `ServoControllerManager.ino` находятся в одной директории.
	- Создайте файл `requirements.txt`, если у вас есть зависимости.

2. **Создание .exe с помощью PyInstaller:**

- Откройте терминал и перейдите в директорию с вашим скриптом:

```bash  
cd /path/to/your/script
```

-  Запустите PyInstaller:
- Откройте терминал и перейдите в директорию с вашим скриптом:

```bash
pyinstaller --onefile --add-data "ServoControllerManager.ino;." your_script.py
```    

Параметры:
- `--onefile`: Создает единый .exe файл.
- `--add-data "ServoControllerManager.ino;."`: Добавляет файл `.ino` в ту же директорию, где будет находиться исполняемый файл.

3. После завершения сборки, файл `.exe` появится в папке `dist`.

### 3. Создание установочного файла

1. **Создание установщика с Inno Setup:**
    
    - Запустите Inno Setup и создайте новый скрипт, используя Wizard.
    - В разделе `Application files` укажите путь к скомпилированному `.exe` и к файлу `ServoControllerManager.ino`.
    - В `Application main executable file` укажите путь к вашему .exe.
    
    Пример секции скрипта для копирования файла `.ino`:
    
    innosetup
    
    `[Files] Source: "dist\your_script.exe"; DestDir: "{app}" Source: "ServoControllerManager.ino"; DestDir: "{app}"`
    
2. **Добавление установки Arduino CLI:**
    
    - Скачайте установочный файл `Arduino CLI` или укажите URL для загрузки.
    - В скрипте Inno Setup добавьте секцию для скачивания и установки Arduino CLI:
    
    innosetup
    
    Копировать код
    
    `[Run] Filename: "{app}\arduino-cli.exe"; Parameters: "core install arduino:avr"; Flags: runhidden`
    
    Это запустит установку `Arduino CLI` после установки вашей программы.
    
3. **Компиляция установочного файла:**
    
    - Нажмите "Compile" в Inno Setup, чтобы создать установочный файл.

### 4. Тестирование

После создания установочного файла запустите его на тестовой машине, чтобы убедиться, что установка происходит корректно, а все файлы находятся на своих местах.

### Дополнительные рекомендации

- Убедитесь, что в скрипте обработаны пути к файлам, чтобы они корректно работали как в собранном `.exe`, так и в исходной директории.
- Проверьте, чтобы инсталлятор Arduino CLI был совместим с системой пользователя (x86/x64).